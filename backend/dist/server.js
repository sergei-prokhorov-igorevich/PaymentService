(()=>{"use strict";var e={349:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.EHttpStatusCode=void 0,function(e){e[e.Ok=200]="Ok",e[e.BadRequest=400]="BadRequest",e[e.NotFound=404]="NotFound"}(n||(n={})),t.EHttpStatusCode=n},607:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function u(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(u){return function(c){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,r=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=t.call(e,a)}catch(e){u=[6,e],r=0}finally{n=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,c])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(860),a=n(582),u=n(428),c=n(645),s=n(889),l=n(356),f="/api/v1",d=process.env.PORT||81;r(void 0,void 0,void 0,(function(){var e,t;return o(this,(function(n){switch(n.label){case 0:return[4,(0,c.initLogger)()];case 1:return n.sent(),[4,(0,l.connectMongoDb)()];case 2:return n.sent(),[4,(0,u.createOrderRouter)()];case 3:return e=n.sent(),t=(0,s.createLoggerRouter)(),i().use(a()).use(i.json()).use("".concat(f,"/order"),e).use("".concat(f,"/logger"),t).listen(d,(function(){return console.log("Server started at http://localhost:".concat(d).concat(f))})),[2]}}))}))},608:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function u(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(u){return function(c){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,r=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=t.call(e,a)}catch(e){u=[6,e],r=0}finally{n=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,c])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.payByOrder=t.getOrderByGuid=void 0;var i=n(720);t.getOrderByGuid=function(e){return r(void 0,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return[4,i.Order.findOne({orderGuid:e})];case 1:return[2,t.sent()]}}))}))},t.payByOrder=function(e,t){return r(void 0,void 0,void 0,(function(){var n;return o(this,(function(r){switch(r.label){case 0:return t?(n=Boolean,[4,i.Order.findOne({orderGuid:e})]):[2,!1];case 1:return[2,n.apply(void 0,[r.sent()])]}}))}))}},356:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function u(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(u){return function(c){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,r=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=t.call(e,a)}catch(e){u=[6,e],r=0}finally{n=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,c])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.connectMongoDb=void 0;var i=n(185),a=n(285);t.connectMongoDb=function(){return r(this,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return i.connection.on("error",console.error.bind(console,"Mongoose connection error: ")),i.connection.once("open",(function(){console.log("Mongoose connected successfully")})),[4,(0,i.connect)(a.mongodbConnectionString,{dbName:"PaymentService"})];case 1:return e.sent(),[2]}}))}))}},720:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Order=void 0;var r=n(185),o=new r.Schema({orderGuid:String,orderId:String,payerId:String,amount:Number,currency:String,paymentMethod:String}),i=(0,r.model)("Order",o,"orders");t.Order=i},285:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.mongodbConnectionString=void 0,t.mongodbConnectionString="mongodb://test:1234567890@ac-jtr4crw-shard-00-00.ewby6hr.mongodb.net:27017,ac-jtr4crw-shard-00-01.ewby6hr.mongodb.net:27017,ac-jtr4crw-shard-00-02.ewby6hr.mongodb.net:27017/?ssl=true&replicaSet=atlas-8y3te6-shard-0&authSource=admin&retryWrites=true&w=majority"},889:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function u(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(u){return function(c){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,r=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=t.call(e,a)}catch(e){u=[6,e],r=0}finally{n=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,c])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.createLoggerRouter=void 0;var i=n(860),a=n(645);t.createLoggerRouter=function(){var e=(0,i.Router)();return e.get("/getAll",(function(e,t){return r(void 0,void 0,void 0,(function(){var e;return o(this,(function(n){switch(n.label){case 0:return[4,(0,a.readAllLogs)()];case 1:return e=n.sent().replace("\r\n","<br>"),t.send(e),[2]}}))}))})),e}},428:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function u(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(u){return function(c){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,r=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=t.call(e,a)}catch(e){u=[6,e],r=0}finally{n=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,c])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.createOrderRouter=void 0;var i=n(860),a=n(608),u=n(349),c=n(645);t.createOrderRouter=function(){return r(void 0,void 0,void 0,(function(){var e;return o(this,(function(t){return(e=(0,i.Router)()).get("/:orderGuid",(function(e,t){return r(void 0,void 0,void 0,(function(){var n,r;return o(this,(function(o){switch(o.label){case 0:return n=e.params.orderGuid,[4,(0,a.getOrderByGuid)(n)];case 1:return(r=o.sent())?t.send(r):t.sendStatus(u.EHttpStatusCode.NotFound),[2]}}))}))})),e.post("/:orderGuid",(function(e,t){return r(void 0,void 0,void 0,(function(){var n,r,i,s;return o(this,(function(o){switch(o.label){case 0:return n=e.params.orderGuid,(r=e.body.password)?[4,(0,a.payByOrder)(n,r)]:((0,c.log)(c.ELogLevel.Warning,"password is empty."),t.sendStatus(u.EHttpStatusCode.BadRequest),[2]);case 1:return i=o.sent(),s=i?u.EHttpStatusCode.Ok:u.EHttpStatusCode.NotFound,t.sendStatus(s),[2]}}))}))})),[2,e]}))}))}},645:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function u(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(u){return function(c){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,r=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=t.call(e,a)}catch(e){u=[6,e],r=0}finally{n=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,c])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.readAllLogs=t.log=t.initLogger=t.ELogLevel=void 0;var i,a=n(292),u=n(17),c=n(147),s=u.resolve("".concat(__dirname,"/../logs/")),l="".concat(s,"/").concat(c.name,".txt");!function(e){e[e.Verbose=0]="Verbose",e[e.Debug=1]="Debug",e[e.Info=2]="Info",e[e.Warning=3]="Warning",e[e.Error=4]="Error"}(i||(i={})),t.ELogLevel=i,t.initLogger=function(){return r(void 0,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,4]),[4,a.stat(s)];case 1:case 3:return e.sent(),[3,4];case 2:return e.sent(),[4,a.mkdir(s)];case 4:return e.trys.push([4,6,,8]),[4,a.stat(l)];case 5:case 7:return e.sent(),[3,8];case 6:return e.sent(),[4,a.writeFile(l,"")];case 8:return[2]}}))}))},t.log=function(e,t,n){return r(void 0,void 0,void 0,(function(){var r,u;return o(this,(function(o){switch(o.label){case 0:return r={datetime:(new Date).toISOString(),level:i[e],message:t,obj:n},u="".concat(JSON.stringify(r),"\r\n"),[4,a.appendFile(l,u)];case 1:return[2,o.sent()]}}))}))},t.readAllLogs=function(){return r(void 0,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return[4,a.readFile(l)];case 1:return[2,e.sent().toString()]}}))}))}},582:e=>{e.exports=require("cors")},860:e=>{e.exports=require("express")},185:e=>{e.exports=require("mongoose")},292:e=>{e.exports=require("fs/promises")},17:e=>{e.exports=require("path")},147:e=>{e.exports=JSON.parse('{"name":"simple-payment-service-backend","description":"It\'s a simple payment service application. https://github.com/sergei-prokhorov-igorevich/PaymentService/tree/main/","author":"Sergei Prokhorov","version":"1.0.0","private":true,"scripts":{"build":"webpack","watch":"webpack --watch","server":"cross-env PORT=81 nodemon dist/server.js --watch dist -e js","start":"npm-run-all -p watch server"},"keywords":[],"license":"ISC","devDependencies":{"@types/cors":"^2.8.13","@types/express":"^4.17.17","@types/node":"^20.1.5","@typescript-eslint/eslint-plugin":"^5.59.6","@typescript-eslint/parser":"^5.59.6","cross-env":"^7.0.3","eslint":"^8.40.0","eslint-config-airbnb":"^19.0.4","eslint-config-airbnb-typescript":"^17.0.0","eslint-config-standard-with-typescript":"^34.0.1","eslint-plugin-import":"^2.27.5","eslint-plugin-jsx-a11y":"^6.7.1","eslint-plugin-n":"^15.7.0","eslint-plugin-promise":"^6.1.1","nodemon":"^2.0.22","npm-run-all":"^4.1.5","ts-loader":"^9.4.3","ts-node":"^10.9.1","typescript":"^5.0.4","webpack":"^5.85.0","webpack-cli":"^5.1.2","webpack-node-externals":"^3.0.0"},"dependencies":{"cors":"^2.8.5","express":"^4.18.2","mongodb":"^5.5.0","mongoose":"^7.3.0"}}')}},t={};!function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r].call(i.exports,i,i.exports,n),i.exports}(607)})();